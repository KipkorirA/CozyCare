<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='reviews.css') }}"> 
    <title>Reviews</title>
    <script>
        function deleteReview(reviewId) {
            if (!confirm("Are you sure you want to delete this review?")) {
                return; // If user cancels, do nothing
            }

            const reviewElement = document.getElementById(`review-${reviewId}`);
            reviewElement.innerHTML += ' <span class="loading">Deleting...</span>'; // Show loading message

            fetch(`/reviews/delete/${reviewId}`, {
                method: 'DELETE',
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                alert(data.message);
                // Remove the review from the page
                reviewElement.remove();
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
                alert('There was an error deleting the review.');
                reviewElement.innerHTML = reviewElement.innerHTML.replace(' <span class="loading">Deleting...</span>', ''); // Remove loading message
            });
        }
    </script>
</head>
<body>
    <h1>Submitted Reviews</h1>
    <ul>
        {% for review in reviews %}
        <li id="review-{{ review.id }}">
            <strong>{{ review.name }}</strong> ({{ review.rating }} stars)
            <p>{{ review.feedback_text }}</p>
            <button onclick="deleteReview({{ review.id }})">Delete Review</button>
        </li>
        {% endfor %}
    </ul>
</body>
</html>
